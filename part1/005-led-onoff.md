# Управление светодиодом

Итак, ты написал программу, которая может здороваться с миром или с любым, кто ее попросит об этом. Теперь пришло время научиться управлять внешним миром. Сказать по правде, не каждый программист умеет делать это, а ты в конце урока научишься.

> Главное, что нужно усвоить перед уроком не подключай ничего к включенной Raspberry Pi, она обязательно сгорит, если делать это.

## Что нужно для урока?

* Маломощный светодиод любого цвета
* Резистор на 330 Ом
* Коннекторы
* Breadboard

И еще немного подучить JavaScript...

## if

Иногда тебе понадобится выполнять что-то зависимости от условий. Для этого в JavaScript исполюзуют инструкцию ```if(condition) {...}```. Инструкция вычисляет условие в круглых скобках и выполняет блок кода, исли он сложный, то должен быть в фигурных скобках, если он из одной строки, то скобки можно опустить, но я не рекомендую тебе делать этого, так как код становится менее читаемым. Пример:

```js
if(year === 2022) {
    console.log('yes');
}
```

Тут проверяется, что переменная ```year``` равна 2022, и если это так, то выводится в консоль ```yes```.

У инструкции ```if```, может быть блок ```else```. Если условие не выполняется, то выполняется он:

```js
if(year === 2022) {
    console.log('yes');
} else {
    console.log('no');
}
```

А еще может быть несколько условий, их перечисляют в блоке ```else if```:

```js
if(year === 2022) {
    console.log('this year');
} else if(year === 2021) {
    console.log('last year');
} else if(year < 2021) {
    console.log('for a long time');
} else {
    console.log('unknown time');
}
```
Сперва вычисляется ```year === 2022```, если оно ложно, то ```year === 2021```, если оно ложно, то ```year < 2021```,
а если и оно ложно то выполняется блок за ```else```.

## Модуль onoff.

Было бы грустно, если бы любую программу надо было бы писать каждый раз с нуля. К счастью, очень много кода уже было написано до тебя. И сообщество разработчиков активно делится им через npm репозиторий. Код по назначению объединяется в модули, которые можно устанавливать и использовать.

Для работы с пинами нам понадобится модуль ```onoff-debug```. Чтобы подключить его к нашей программе выполните в консоли:

```sh
npm install onoff-debug
```

Модуль является оберткой над модулем ```onoff``` и позволяет запускать и отлаживать твою программу на персональном компьютере.

## А теперь программа

В нашем проекте *hello* создай файл ```onoff.js```, со следующим содержимым:

```js
/**
 * Подключение функции конструктора из модуля
 **/
import {Gpio} from 'onoff-debug';
/**
 * Создание объекта вывода(out), связанного со вторым пином.
 * reconfigureDirection говорит о том, что не надо обнулять состояние raspberry pi
 **/
const pin2 = new Gpio(2, 'out', 'both', {reconfigureDirection: false});
/**
 * Чтение значения второго пина
 * и сравнение с единицей
 **/
if(pin2.readSync() === 1){
/**
 * Запись нуля во второй пин
 **/
    pin2.writeSync(0);
} else {
/**
 * Запись единицы во второй пин
 **/
    pin2.writeSync(1);
}
/**
 * Чтение значения второго пина и вывод его в консоль
 **/
console.log(pin2.readSync());
```

Чтобы программа запускалась, добавь в ```package.json``` в раздел ```bin```:

```json
"onoff": "./onoff.js"
```

Установи:

```sh
npm install -g . 
```

И запусти:

```sh
onoff
```

> Если Raspberry Pi имеет архитектуру Armv6, то есть довольно старая, к сожалению управление пинами не поддерживается полностью, вместо команды onoff, доступной из любой дирректории, тебе придется запускать ее явно с аргументом ```--no-expose-wasm```:

> ```node --no-expose-wasm ./onoff.js```

> Это можно обойти, но это не тема для наших уроков.

Попробуй самостоятельно изменить программу, чтобы можно было передать номер пина через аргументы: ```onoff 3```

Теперь залей изменения в github и синхронизируй с raspberry pi.

Команду уже можно запускать.

Осталось только правильно подключить светодиод к пину.

## Подключение светодиода